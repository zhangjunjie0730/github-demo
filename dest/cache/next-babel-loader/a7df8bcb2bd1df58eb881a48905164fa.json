{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"E:\\\\MyGit\\\\github-demo\\\\components\\\\DetailLayout\\\\index.jsx\",\n    _this = this;\n\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Link from 'next/link';\nimport { withRouter } from 'next/router';\nimport Repo from '../Repo';\nimport { request } from '../../utils/api';\nimport initCache from '../../utils/client-cache';\nimport { genDetailCacheKeyStrate, genDetailCacheKey } from '../../utils'; // 将对象格式参数转成 ?user=zjj&name=blog 形式\n\nfunction makeQuery(queryObject) {\n  var query = Object.entries(queryObject).reduce(function (result, entry) {\n    result.push(entry.join('='));\n    return result;\n  }, []).join('&');\n  return \"?\".concat(query);\n}\n\nvar _initCache = initCache({\n  genCacheKeyStrate: genDetailCacheKeyStrate\n}),\n    cache = _initCache.cache,\n    useCache = _initCache.useCache;\n\nvar DetailLayout = function DetailLayout(Comp) {\n  var _s = $RefreshSig$();\n\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'index';\n\n  var WithDetail = function WithDetail(_ref) {\n    _s();\n\n    var repoBasic = _ref.repoBasic,\n        router = _ref.router,\n        rest = _objectWithoutProperties(_ref, [\"repoBasic\", \"router\"]);\n\n    useCache(genDetailCacheKey(router), _objectSpread({\n      repoBasic: repoBasic\n    }, rest));\n    var query = makeQuery(router.query);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"jsx-2811407121\" + \" \" + \"root\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"jsx-2811407121\" + \" \" + \"repo-basic\",\n        children: [/*#__PURE__*/_jsxDEV(Repo, {\n          repo: repoBasic\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"jsx-2811407121\" + \" \" + \"tabs\",\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            href: \"/detail\".concat(query),\n            children: type === 'index' ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"jsx-2811407121\" + \" \" + \"tab\",\n              children: \"Readme\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 34,\n              columnNumber: 17\n            }, _this) : /*#__PURE__*/_jsxDEV(\"a\", {\n              title: \"readme\",\n              className: \"jsx-2811407121\" + \" \" + \"tab index\",\n              children: \"Readme\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 36,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 32,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/detail/issues\".concat(query),\n            children: type === 'issues' ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"jsx-2811407121\" + \" \" + \"tab\",\n              children: \"Issues\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 43,\n              columnNumber: 17\n            }, _this) : /*#__PURE__*/_jsxDEV(\"a\", {\n              title: \"issues\",\n              className: \"jsx-2811407121\" + \" \" + \"tab issues\",\n              children: \"Issues\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 45,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"jsx-2811407121\",\n        children: /*#__PURE__*/_jsxDEV(Comp, _objectSpread({}, rest), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(_JSXStyle, {\n        id: \"2811407121\",\n        children: \".root.jsx-2811407121{padding-top:20px;}.repo-basic.jsx-2811407121{padding:20px;border:1px solid #eee;margin-bottom:20px;border-radius:5px;}.tab.jsx-2811407121+.tab.jsx-2811407121{margin-left:20px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkU6XFxNeUdpdFxcZ2l0aHViLWRlbW9cXGNvbXBvbmVudHNcXERldGFpbExheW91dFxcaW5kZXguanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXVEVyxBQUdnQyxBQUlKLEFBT0ksYUFOSyxJQUp4QixBQVdBLGtCQU5xQixtQkFDRCxrQkFDcEIiLCJmaWxlIjoiRTpcXE15R2l0XFxnaXRodWItZGVtb1xcY29tcG9uZW50c1xcRGV0YWlsTGF5b3V0XFxpbmRleC5qc3giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnO1xyXG5pbXBvcnQgeyB3aXRoUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInO1xyXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9SZXBvJztcclxuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaSc7XHJcbmltcG9ydCBpbml0Q2FjaGUgZnJvbSAnLi4vLi4vdXRpbHMvY2xpZW50LWNhY2hlJztcclxuaW1wb3J0IHsgZ2VuRGV0YWlsQ2FjaGVLZXlTdHJhdGUsIGdlbkRldGFpbENhY2hlS2V5IH0gZnJvbSAnLi4vLi4vdXRpbHMnO1xyXG4vLyDlsIblr7nosaHmoLzlvI/lj4LmlbDovazmiJAgP3VzZXI9empqJm5hbWU9YmxvZyDlvaLlvI9cclxuZnVuY3Rpb24gbWFrZVF1ZXJ5KHF1ZXJ5T2JqZWN0KSB7XHJcbiAgY29uc3QgcXVlcnkgPSBPYmplY3QuZW50cmllcyhxdWVyeU9iamVjdClcclxuICAgIC5yZWR1Y2UoKHJlc3VsdCwgZW50cnkpID0+IHtcclxuICAgICAgcmVzdWx0LnB1c2goZW50cnkuam9pbignPScpKTtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sIFtdKVxyXG4gICAgLmpvaW4oJyYnKTtcclxuICByZXR1cm4gYD8ke3F1ZXJ5fWA7XHJcbn1cclxuXHJcbmNvbnN0IHsgY2FjaGUsIHVzZUNhY2hlIH0gPSBpbml0Q2FjaGUoe1xyXG4gIGdlbkNhY2hlS2V5U3RyYXRlOiBnZW5EZXRhaWxDYWNoZUtleVN0cmF0ZSxcclxufSk7XHJcblxyXG5jb25zdCBEZXRhaWxMYXlvdXQgPSAoQ29tcCwgdHlwZSA9ICdpbmRleCcpID0+IHtcclxuICBjb25zdCBXaXRoRGV0YWlsID0gKHsgcmVwb0Jhc2ljLCByb3V0ZXIsIC4uLnJlc3QgfSkgPT4ge1xyXG4gICAgdXNlQ2FjaGUoZ2VuRGV0YWlsQ2FjaGVLZXkocm91dGVyKSwgeyByZXBvQmFzaWMsIC4uLnJlc3QgfSk7XHJcbiAgICBjb25zdCBxdWVyeSA9IG1ha2VRdWVyeShyb3V0ZXIucXVlcnkpO1xyXG5cclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVwby1iYXNpY1wiPlxyXG4gICAgICAgICAgPFJlcG8gcmVwbz17cmVwb0Jhc2ljfSAvPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJzXCI+XHJcbiAgICAgICAgICAgIDxMaW5rIGhyZWY9e2AvZGV0YWlsJHtxdWVyeX1gfT5cclxuICAgICAgICAgICAgICB7dHlwZSA9PT0gJ2luZGV4JyA/IChcclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRhYlwiPlJlYWRtZTwvc3Bhbj5cclxuICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgPGEgdGl0bGU9XCJyZWFkbWVcIiBjbGFzc05hbWU9XCJ0YWIgaW5kZXhcIj5cclxuICAgICAgICAgICAgICAgICAgUmVhZG1lXHJcbiAgICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9MaW5rPlxyXG4gICAgICAgICAgICA8TGluayBocmVmPXtgL2RldGFpbC9pc3N1ZXMke3F1ZXJ5fWB9PlxyXG4gICAgICAgICAgICAgIHt0eXBlID09PSAnaXNzdWVzJyA/IChcclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRhYlwiPklzc3Vlczwvc3Bhbj5cclxuICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgPGEgdGl0bGU9XCJpc3N1ZXNcIiBjbGFzc05hbWU9XCJ0YWIgaXNzdWVzXCI+XHJcbiAgICAgICAgICAgICAgICAgIElzc3Vlc1xyXG4gICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgIDwvTGluaz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXY+XHJcbiAgICAgICAgICA8Q29tcCB7Li4ucmVzdH0gLz5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8c3R5bGUganN4PlxyXG4gICAgICAgICAge2BcclxuICAgICAgICAgICAgLnJvb3Qge1xyXG4gICAgICAgICAgICAgIHBhZGRpbmctdG9wOiAyMHB4O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAucmVwby1iYXNpYyB7XHJcbiAgICAgICAgICAgICAgcGFkZGluZzogMjBweDtcclxuICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZWVlO1xyXG4gICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XHJcbiAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAudGFiICsgLnRhYiB7XHJcbiAgICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDIwcHg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIGB9XHJcbiAgICAgICAgPC9zdHlsZT5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH07XHJcblxyXG4gIFdpdGhEZXRhaWwuZ2V0SW5pdGlhbFByb3BzID0gY2FjaGUoYXN5bmMgY29udGV4dCA9PiB7XHJcbiAgICBjb25zdCB7IGN0eCB9ID0gY29udGV4dDtcclxuICAgIGNvbnN0IHsgb3duZXIsIG5hbWUgfSA9IGN0eC5xdWVyeTtcclxuICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgcmVxdWVzdCh7IHVybDogYC9yZXBvcy8ke293bmVyfS8ke25hbWV9YCB9LCBjdHgucmVxLCBjdHgucmVzKTtcclxuXHJcbiAgICBsZXQgcHJvcHNEYXRhID0ge307XHJcbiAgICBpZiAoQ29tcC5nZXRJbml0aWFsUHJvcHMpIHByb3BzRGF0YSA9IGF3YWl0IENvbXAuZ2V0SW5pdGlhbFByb3BzKGNvbnRleHQpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlcG9CYXNpYzogZGF0YSxcclxuICAgICAgLi4ucHJvcHNEYXRhLFxyXG4gICAgfTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHdpdGhSb3V0ZXIoV2l0aERldGFpbCk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEZXRhaWxMYXlvdXQ7XHJcbiJdfQ== */\\n/*@ sourceURL=E:\\\\\\\\MyGit\\\\\\\\github-demo\\\\\\\\components\\\\\\\\DetailLayout\\\\\\\\index.jsx */\"\n      }, void 0, false, void 0, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 7\n    }, _this);\n  };\n\n  _s(WithDetail, \"MWIIAj4RCYLIAOTG2F1uW9bftBE=\", false, function () {\n    return [useCache];\n  });\n\n  WithDetail.getInitialProps = cache( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(context) {\n      var ctx, _ctx$query, owner, name, _yield$request, data, propsData;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              ctx = context.ctx;\n              _ctx$query = ctx.query, owner = _ctx$query.owner, name = _ctx$query.name;\n              _context.next = 4;\n              return request({\n                url: \"/repos/\".concat(owner, \"/\").concat(name)\n              }, ctx.req, ctx.res);\n\n            case 4:\n              _yield$request = _context.sent;\n              data = _yield$request.data;\n              propsData = {};\n\n              if (!Comp.getInitialProps) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 10;\n              return Comp.getInitialProps(context);\n\n            case 10:\n              propsData = _context.sent;\n\n            case 11:\n              return _context.abrupt(\"return\", _objectSpread({\n                repoBasic: data\n              }, propsData));\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n  return withRouter(WithDetail);\n};\n\n_c = DetailLayout;\nexport default DetailLayout;\n\nvar _c;\n\n$RefreshReg$(_c, \"DetailLayout\");","map":{"version":3,"sources":["E:/MyGit/github-demo/components/DetailLayout/index.jsx"],"names":["Link","withRouter","Repo","request","initCache","genDetailCacheKeyStrate","genDetailCacheKey","makeQuery","queryObject","query","Object","entries","reduce","result","entry","push","join","genCacheKeyStrate","cache","useCache","DetailLayout","Comp","type","WithDetail","repoBasic","router","rest","getInitialProps","context","ctx","owner","name","url","req","res","data","propsData"],"mappings":"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","sourcesContent":["import Link from 'next/link';\r\nimport { withRouter } from 'next/router';\r\nimport Repo from '../Repo';\r\nimport { request } from '../../utils/api';\r\nimport initCache from '../../utils/client-cache';\r\nimport { genDetailCacheKeyStrate, genDetailCacheKey } from '../../utils';\r\n// 将对象格式参数转成 ?user=zjj&name=blog 形式\r\nfunction makeQuery(queryObject) {\r\n  const query = Object.entries(queryObject)\r\n    .reduce((result, entry) => {\r\n      result.push(entry.join('='));\r\n      return result;\r\n    }, [])\r\n    .join('&');\r\n  return `?${query}`;\r\n}\r\n\r\nconst { cache, useCache } = initCache({\r\n  genCacheKeyStrate: genDetailCacheKeyStrate,\r\n});\r\n\r\nconst DetailLayout = (Comp, type = 'index') => {\r\n  const WithDetail = ({ repoBasic, router, ...rest }) => {\r\n    useCache(genDetailCacheKey(router), { repoBasic, ...rest });\r\n    const query = makeQuery(router.query);\r\n\r\n    return (\r\n      <div className=\"root\">\r\n        <div className=\"repo-basic\">\r\n          <Repo repo={repoBasic} />\r\n          <div className=\"tabs\">\r\n            <Link href={`/detail${query}`}>\r\n              {type === 'index' ? (\r\n                <span className=\"tab\">Readme</span>\r\n              ) : (\r\n                <a title=\"readme\" className=\"tab index\">\r\n                  Readme\r\n                </a>\r\n              )}\r\n            </Link>\r\n            <Link href={`/detail/issues${query}`}>\r\n              {type === 'issues' ? (\r\n                <span className=\"tab\">Issues</span>\r\n              ) : (\r\n                <a title=\"issues\" className=\"tab issues\">\r\n                  Issues\r\n                </a>\r\n              )}\r\n            </Link>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <Comp {...rest} />\r\n        </div>\r\n        <style jsx>\r\n          {`\r\n            .root {\r\n              padding-top: 20px;\r\n            }\r\n\r\n            .repo-basic {\r\n              padding: 20px;\r\n              border: 1px solid #eee;\r\n              margin-bottom: 20px;\r\n              border-radius: 5px;\r\n            }\r\n\r\n            .tab + .tab {\r\n              margin-left: 20px;\r\n            }\r\n          `}\r\n        </style>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  WithDetail.getInitialProps = cache(async context => {\r\n    const { ctx } = context;\r\n    const { owner, name } = ctx.query;\r\n    const { data } = await request({ url: `/repos/${owner}/${name}` }, ctx.req, ctx.res);\r\n\r\n    let propsData = {};\r\n    if (Comp.getInitialProps) propsData = await Comp.getInitialProps(context);\r\n\r\n    return {\r\n      repoBasic: data,\r\n      ...propsData,\r\n    };\r\n  });\r\n\r\n  return withRouter(WithDetail);\r\n};\r\n\r\nexport default DetailLayout;\r\n"]},"metadata":{},"sourceType":"module"}